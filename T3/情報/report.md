---
documentclass: ltjsarticle
title: ネットワークサーバ構築演習
author: T340 山口雄大
header-includes:
  - \usepackage[margin=1in]{geometry}
  - \usepackage{longtable}
  - \usepackage{booktabs}
figureTitle: "図"
tableTitle: "表"
listingTitle: "コード"
figPrefix: "図"
eqnPrefix: "式"
tblPrefix: "表"
lstPrefix: "コード"
---

# 目的 
&emsp;サーバ構築の準備 サーバ用OSのInstallとネットワークの設定

# 原理(理論)
## ソフトウェアの種類
&emsp;計算機のソフトウェアは大きく分けて3種類ある。

### 基本ソフトウェア
&emsp;OS(Operating System)とも言う。計算機を簡単に操作できるようにするためのソフトウェア。

### アプリケーション(応用ソフトウェア)
&emsp;計算機で目的の作業を行うために作成されたソフトウェア。

### ミドルウェア
&emsp;日本語変換を提供するなどアプリケーション内で呼び込まれ利用されるソフトウェア

## OSの種類
- OSにはクライアント用OSとしてマイクロソフトのWindows系OS(Windows10、Windows11)にUnix系の2種類が主に使われているほかにアップル社のマックで使われているiOSがあるがiOS自体はUnix系のOSである。スマートフォンでAndroidはLinux系のOS、iPhoneはiOSなので共にUnix系である。  
- サーバ用OSとしてマイクロソフトのWindows ServerとUnix系がある。  

## ネットワークサーバ用OSにUnix系が多く用いられる理由
&emsp;1980年代に小型の計算機で利用できるOSとして設計段階からネットワーク機能を実装されており、ネットワークサーバ機能との融和性がマイクロソフト系OSより高い。比較してマイクロソフト系のOSは開発段階でネットワークは実装されず、のちに必要に応じてネットワーク機能が付け加えられた。  

## OSのアップデートの必要性
&emsp;提供後のOSには少なからず不具合や特に問題となるネットワーク上のバグが含まれている可能性がある。特にネットワーク状でサービスを提供するサーバは攻撃を受けやすく、クラッカーに乗っ取られ悪用された場合は法的な責任を負わされる可能性がある。これらを回避するためには、OSの提供後に判明した不具合やバグをOSの提供サーバから修正差分を受け取るUpdateという作業を行う必要がある。

## IPアドレスの基本
&emsp;インターネット・プロトコール・アドレス(IP アドレス)はコンピュータネットワーク状で通信を行うために各計算機に割り当てられる番地のことである。IPアドレスは32ビットで表現されるIPv4と128ビットで表現されるIPv6の2種類がある。IPv4は32ビットのため$2^32$のアドレス空間を持つ。一方、IPv6では128ビットのため$2^128$のアドレス空間を持つ。

### グローバルアドレスとプライベートアドレス
&emsp;IPv4の32ビットアドレスには全世界中での通信を可能にするグローバルアドレスと組織内で利用されるプライベートアドレスの2種類が用意されている。一般的には1つのグローバルIPで約1000個のプライベートIPの利用が可能であるため、しばらくはIPv4での運用が可能になっている。  

### ネットワークアドレスとホストアドレス
&emsp;IPv4の32ビット体系をネットワークアドレスとホストアドレスの2つの部分に分けて運用が行われている。

![ネットワークアドレスとホストアドレスの割り当て(情報処理技術者試験より引用した図)](./fig1.jpg)

&emsp;4クラスの分別を先頭ビットで行い、運用規模にあわせてクラスA~Dを使い分ける。  
ネットワークアドレスは運用するLANの範囲を定義し、ホストアドレスは接続する機器に1対1で割り当てる。同じLANないに同一のIPアドレスが存在することは許されない。  
&emsp;本校は規模的にクラスBのアドレス体系で運用されている。ホストアドレスはネットワーク運用管理者が自由に設定できる範囲で一般的にはホストアドレスの一部(上位ビットから指定した範囲)をサブネットアドレスをして用い、残りのビットで情報機器に1対1でアドレスを割り当てる。

## ネットワークアドレスの意味
&emsp;今回は荒川キャンパルのネットワーク構成を例として説明を行う。LANないのネットワーク設計には組織の形態と建物の構造に則した設計がなされる。本稿では教員用のネットワークと学生用ネットワークに分けて運用されている。T3の教室は4階にあるためプライベートIPとして172.16.34.0/24が割り当てられ、8階のICT実験室は172.16.28.0/24が割り当てられている。  
&emsp;4階と8階のIPアドレスを比較してみると先頭から2バイトまでは同じで3バイト目が異なっている。/24は先頭ビットからのネットワークアドレスのビット数を示している。したがって先頭から16ビットまでは校内全体の範囲を示し、先頭8ビットをサブネットアドレスとして利用している階を定義し、残りの8ビットで情報機器に割り当てるホストアドレスとする。

# 本演習に必要なコマンド類
&emsp;本演習に必要なコマンド類を以下の表1にまとめた。  

|操作|コマンドと説明|
|:----:|:----:|
| su | Super Userの略<br>rootユーザーと通常ユーザーへの変更を行うコマンド |
| exit | ユーザーをログアウトする<br>本演習ではrootユーザーから通常ユーザーに戻るのに使用した |
| cd | ディレクトリを移動するコマンド |
| ls | ファイルやディレクトリを一覧で表示できるコマンド | 
| cat | ファイルの内容や中身、行番号を表示させるコマンド | 
| ln | シンボリックリンクを作成するコマンド |
| cp | ファイルやディレクトリをコピーするコマンド | 
| mv | ファイルやディレクトリの移動および名前の変更を行うコマンド |
| chmod | アクセス権限を変更したり、実行権限を付与させるコマンド |
| vi |  Linuxの標準テキストエディタを起動させるコマンド | 

:コマンドと説明 {#tbl:コマンドと説明}

# 実験手順
本演習で使用した私のパラメータシートを以下の表2にまとめた。

\clearpage

|名前|内容|
|:----:|:----:|
| ホスト名 | pc10.s10.ts.metro-cit.ac.jp | 
| IPアドレスとネットマスク | 192.168.0.110/24 |
| デフォルトゲートウェイ | 192.168.0.1 |

:パラメータシート {#tbl:パラメータシート}

## OSのインストール

1. 計算機の電源を入れた。  
2. BIOS(Basic Input System)が立ち上がり製造メーカーであるDELLのマークが画面に表示される。この時画
面右上にBoot方法のメッセージが表示されるのでファンクションキーのF11を押した。  
3. Boot Manager画面が表示された。  
4. カーソルキーを使ってBoot Settingを選択した。  
5. Boot Setting画面でSet Legacy Hard Disk Drive Orderをカーソルキーで選択した。  
6. Hard Disk Order画面内でカーソルキーを使って、Hard Disk Drive#00を選択し、Enterキーを押し、カーソルキーでSan DISKを選択した。  
7. キーボード左上にあるEscキーを押した。設定内容を保存するか画面で問い合わせるが出るのでYキーを押した。  
8. Boot Manager面に戻るためにEscキーを押した。  
9. Boot Manager画面に戻ったらEnterキーを押した。これでinstallが開始された。  
10. USBメモリーから起動し、install画面が表示された。  
11. Install CentOS 7をカーソルキーで選択し、Enterキーを押した。  
12. Install用の言語を選択した。今回は日本語を選択した。  
13. キーボードの選択は言語を日本語にすると自動的に日本語キーボードに設定される。
14. インストールの概要に進んだ。  
15. 地域設定とインストール先、ネットワークとホスト名、ソフトウェアの選択を順次行った。  
16. 地域設定をマウスでクリック アジア・東京 タイムゾーンを確認し、時刻を適切に合わせた。設定が終わ
れば画面左上の完了をクリックした。  
17.  インストール先をクリックした。500GBのハードディスクを選択し、画面左上の完了をクリックした。  
18.  インストールオプションの画面に切り替わった。右下の領域の確保をクリックし、その後領域の再利用をク
リックした。これでインストール先のハードディスクが利用できるようになった。  
19.  ネットワークの設定をクリックした。設定画面が表示された。  
20.  画面左下のホスト名を各自のパラメーターシートに記載されたホスト名を入力した。  
21.  画面右下の設定をクリックした。ネットワークの手動設定の画面に移行した。  
22.  IPv4セッティングをマウスで選択し、方式をバーの右側のマークをクリックして手動を選択した。  
23.  アドレスの追加をクリックし、アドレス、ネットマスク、ゲートウェイを各自のパラメーターシートの値を
入力した。  
24.  DNSサーバの欄はICT演習室のDNSサーバのIPアドレス192.168.0.100を入力し、保存をクリックして
設定画面を終了した。  
25.  ネットワークとホスト名設定画面の右上の完了をクリックした。  
26.  ソフトウェアの選択をマウスで選択し、ソフトウェアの設定画面に移行した。  
27.  画面真中あたりの「サーバ(GUI使用)」にマウスでチェックを入れ、完了をクリックした。  
28.  これでインストールが開始され、環境設定に移行した。  
29.  ユーザの設定画面で「Rootパスワード」の設定をクリックした。  
30.  入力された文字は表示そのままは表示されずに●により文字列の長さが表示された。間違いを避けるために
確認用に同じパスワードを入力した。2つの文字列が一致すると完了ボタンを押し、終了させた。  
31.  ユーザの作成をクリックした。フルネームは各自の名前を入力した。ユーザ名は指定されたユーザ名を入力
した。  
32.  パスワードをRoot時と同じ要領で入力し、パスワードの確認にも入力し2つが一致すれば完了ボタンを押
し、インストール時の設定が終了した。  
33.  以上の設定を終了しても多分インストールは終了しなかった。次の画面が出るまで待機した。  
34.  画面下で完了しましたと表示が出れば画面右下の再起動をクリックした。  
35.  インストール時の設定終了画面(終了プロセスが表示されている)が終わり、いったん画面が真っ黒になり再
び画面に起動表示(起動プロセスの表示)が出ればUSBメモリーを抜き取った。  
36.  再起動後、ライセンス情報の確認画面に移行した。  
37.  CentOS 7を使用するので「ライセンス契約に同意します」をクリックし、完了をクリックした。  
38.  以上で CentOS 7のインストール作業が終了した。  
39.  ログイン画面が出るのでユーザでログインした。Welcome画面が出るので誠実に対応した。オンラインアカ
ウントはスキップした。以上で使用する準備が完了した。この後「初めて使う人へ」のヘルプ画面が表示され
たが、省略した。  

## ネットワークの設定確認
1. 端末を起動した
2. ネットワークの設定確認コマンドifconfigを端末に入力してEnter気を押した。
3. ifconfigの情報をスクリーンキャプチャした。保存した画像はブラウザーでGoogleにログインしGoogle Driveに保存した。
4. 端末でping 192.168.0.1と入力し、ゲートウェイへの接続確認を行い、スクリーンキャプチャーした。  
5. 端末でhostnameと乳りょし、計算機のホスト名を確認し、スクリーンキャプチャーした。  

## OSのアップデート
1. suコマンドを入力し、インストール時に設定したRootのパスワードを入力した。
2. 端末にyum updateを入力した。
3. 2回確認応答のメッセージが出たのでYを答えた。
4. updateが終了したらexitコマンドを入力した。

# 実験結果
1. ifconfigを入力したときのスクリーンキャプチャーを図2に示した。画面にはIPv4アドレスが192.168.0.110、ネットマスクが255.255.255.0と表示されていて、パラメータシートの値と一致した。  

![ネットワーク設定確認の結果](./fig2.png)

2. ping 192.168.0.1を入力したときのスクリーンキャプチャーを図3に示した。0.4ms以内に応答が来たため、計算機のゲートウェイ接続を確認できた。  

![ゲートウェイ接続確認の結果](./fig3.png)

3. hostnameと入力したときのスクリーンキャプチャーを図4に示した。画面に表示された内容とパラメータシートの値が一致したため、ホスト名も正しく設定できていることが確認できた。

![ホスト名の確認結果](./fig4.png)

# 考察
&emsp;本実験の目的であるサーバ用OSのインストールとネットワークの設定を行うことができた。OSのUpdateの必要性やIPアドレスはネットワーク上での番地を意味することだと学んだ。また、サーバを構築するにはIPアドレス、ネットマスク、ゲートウェイが正しく設定できていないといけないということも学ぶことができた。